A Functional implementation of Deep Learning